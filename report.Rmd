---
title: "IRIS Classification"
author: "Rahul Fernandes"
date: "2023-09-08"
output: html_document
---

## Description

The IRIS Classification Using R repository conducts exploratory data analysis on the IRIS dataset and a Polynomial Support Vector Machine classification model is build to classify the three species of Iris flowers.

## Setting up the environment

Loading Requirements

```{r loading packages, message=FALSE}
library(datasets)
library(dplyr)
library(ggplot2)
library(GGally)
library(caret)
```

## Exploratory Data Analysis
```{r include=FALSE}
iris <- datasets::iris
```
#### Descriptive Statistics
Summary of Statistics for the whole Dataset
```{r echo=FALSE}
summary(iris)
```
Descriptive statistics for Sepal Length by Species
```{r echo=FALSE}
iris %>% 
  group_by(Species) %>% summarize(
    mean(Sepal.Length), sd(Sepal.Length)
    )
```
Descriptive statistics for Sepal Width by Species
```{r echo=FALSE}
iris %>% 
  group_by(Species) %>% summarize(
    mean(Sepal.Width), sd(Sepal.Width)
    )
```
Descriptive statistics for Petal Length by Species
```{r echo=FALSE}
iris %>% 
  group_by(Species) %>% summarize(
    mean(Petal.Length), sd(Petal.Length)
  )
```
Descriptive statistics for Petal Width by Species
```{r echo=FALSE}
iris %>% 
  group_by(Species) %>% summarize(
    mean(Petal.Width), sd(Petal.Width)
  )
```

From the above, the dataset has three species of Iris flowers, Setosa, Versicolor and Virginica. There are 50 samples of each of these species, hence the dataset is balanced and there is no bias. In terms of Sepal Length, Virginica has the highest mean making it generally the on average. In terms of Sepal Width, Setosa has the highest mean making it generally bigger on average. In terms of Petal Width and Length, Virginica has the highest mean making it roughly the biggest species among the three.

#### Relationship Between Sepal and Petal Features
```{r echo=FALSE}
ggplot(iris) +
  geom_point(aes(x=Sepal.Width, y=Sepal.Length), color="red") +
    labs(title = "Sepal Width vs Sepal Length")
```

```{r echo=FALSE}
ggplot(iris) +
  geom_point(aes(x=Petal.Width, y=Petal.Length), color="blue") +
  labs(title = "Petal Width vs Petal Length")
```

#### Relationship Between Features and Species
```{r echo=FALSE}
# Relationship Sepal and Species
ggplot(iris) +
  geom_point(aes(x=Sepal.Width, y=Sepal.Length, color=Species)) +
  facet_wrap(~Species) +
  labs(title = "Relationship Between Sepal and Species")
```

```{r echo=FALSE}
# Relationship Petal and Species
ggplot(iris) +
  geom_point(aes(x=Petal.Width, y=Petal.Length, color=Species)) +
  facet_wrap(~Species) +
  labs(title = "Relationship Between Petal and Species")
```

```{r echo=FALSE}
ggpairs(iris,
        columns = 1:4,
        aes(color = Species),
        upper = list(continuous = "points", combo = "box_no_facet"),
        legend = 2,
        title = "Relationship Between Features by Species"
        )
```

There is an overlap in Sepal features among the three Species and there is no overlap in Petal features among the three species. Theres is almost no overlap between features of the Setosa species, whereas there is overlap over features between Versicolor and Virginica species.

#### Inference from Analysis
From the above information, it can be inferred that Virginica is generally the biggest among the three species of the Iris flower and Setosa is the smallest. The relationship between the features and species shows that there is an overlap of features between Versicolor and Virginica. The mean and standard deviation of Sepal Width are similar among the three species. This might indicate that this feature might not be as important while trying to differentiate between the three species.

## Classification
#### Splitting Dataset
The Dataset is split into two parts, training and testing, 80% of the dataset is used for training and the rest 20% is used for testing.
```{r}
set.seed(100)

TrainingIndex <- createDataPartition(iris$Species, p=0.8, list = FALSE)
TrainingSet <- iris[TrainingIndex,]
TestingSet <- iris[-TrainingIndex,]
```
#### Building the model
```{r}
# Build Training Model
svmModel <- train(Species ~ ., data = TrainingSet,
               method = "svmPoly",
               na.action = na.omit,
               preProcess=c("scale","center"),
               trControl= trainControl(method="none"),
               tuneGrid = data.frame(degree=1,scale=1,C=1)
               )
print(svmModel)
```

#### Testing the model against the testing data
```{r}
# Model performance
svmModel.testing <- predict(svmModel, TestingSet)
svmModel.testing.confusion <- confusionMatrix(svmModel.testing,
                                              TestingSet$Species
                                              )
# Print Confusion Matrix
print(svmModel.testing.confusion)
```

#### Feature Importance
```{r echo=FALSE}
# Feature importance
Importance <- varImp(svmModel)
plot(Importance, col = "red")
```